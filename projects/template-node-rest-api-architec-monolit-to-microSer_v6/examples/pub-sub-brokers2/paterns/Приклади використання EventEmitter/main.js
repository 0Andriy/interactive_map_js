import CoffeeMachine from './CoffeeMachine.js'

const machine = new CoffeeMachine()

// --- ÐÐ°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ ÑÐ»ÑƒÑ…Ð°Ñ‡Ñ–Ð² Ð¿Ð¾Ð´Ñ–Ð¹ (Listeners) ---

// 1. Ð¡Ð»ÑƒÑ…Ð°Ñ‡ Ð´Ð»Ñ Ð¿Ð¾Ñ‡Ð°Ñ‚ÐºÑƒ Ð¿Ñ€Ð¸Ð³Ð¾Ñ‚ÑƒÐ²Ð°Ð½Ð½Ñ
machine.on('start', (coffeeType) => {
    console.log(`â˜• [Listener] ÐŸÐ¾Ñ‡Ð°Ð»Ð°ÑÑ Ñ€Ð¾Ð±Ð¾Ñ‚Ð° Ð½Ð°Ð´ Ð·Ð°Ð¼Ð¾Ð²Ð»ÐµÐ½Ð½ÑÐ¼: ${coffeeType}`)
})

// 2. Ð¡Ð»ÑƒÑ…Ð°Ñ‡ Ð´Ð»Ñ ÑƒÑÐ¿Ñ–ÑˆÐ½Ð¾Ð³Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ
machine.on('done', (details) => {
    console.log(
        `âœ… [Listener] Ð—Ð°Ð¼Ð¾Ð²Ð»ÐµÐ½Ð½Ñ "${details.type}" Ð²Ð¸ÐºÐ¾Ð½Ð°Ð½Ð¾! Ð§Ð°Ñ: ${new Date(
            details.timestamp,
        ).toLocaleTimeString()}`,
    )
})

// 3. ÐžÐ‘ÐžÐ’'Ð¯Ð—ÐšÐžÐ’Ðž: Ð¡Ð»ÑƒÑ…Ð°Ñ‡ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð¾Ð±ÐºÐ¸ Ð¿Ð¾Ð¼Ð¸Ð»Ð¾Ðº
machine.on('error', (error) => {
    console.error(`âŒ [ERROR Listener] Ð¡Ñ‚Ð°Ð»Ð°ÑÑ Ð¿Ð¾Ð¼Ð¸Ð»ÐºÐ° Ð² Ñ€Ð¾Ð±Ð¾Ñ‚Ñ– Ð¼Ð°ÑˆÐ¸Ð½Ð¸: ${error.message}`)
})

// 4. ÐžÐ´Ð½Ð¾Ñ€Ð°Ð·Ð¾Ð²Ð¸Ð¹ ÑÐ»ÑƒÑ…Ð°Ñ‡ Ð´Ð»Ñ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ð¾Ð³Ð¾ ÑÑ‚Ð°Ð½Ñƒ (Ð²Ð¾Ð´Ð° Ð·Ð°ÐºÑ–Ð½Ñ‡Ð¸Ð»Ð°ÑÑ)
// Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑ”Ð¼Ð¾ .once(), ÑÐ¿Ñ€Ð°Ñ†ÑŽÑ” Ð»Ð¸ÑˆÐµ Ð¿ÐµÑ€ÑˆÐ¸Ð¹ Ñ€Ð°Ð·
machine.once('waterEmpty', () => {
    console.log(`ðŸ’§ [CRITICAL Listener] Ð’ÐžÐ”Ð Ð—ÐÐšÐ†ÐÐ§Ð˜Ð›ÐÐ¡Ð¯! ÐŸÐ¾Ñ‚Ñ€Ñ–Ð±Ð½Ð¾ Ñ‚ÐµÑ€Ð¼Ñ–Ð½Ð¾Ð²Ð¾ Ð¿Ð¾Ð¿Ð¾Ð²Ð½Ð¸Ñ‚Ð¸ Ð·Ð°Ð¿Ð°ÑÐ¸.`)
})

// --- Ð—Ð°Ð¿ÑƒÑÐº ÑÑ†ÐµÐ½Ð°Ñ€Ñ–ÑŽ Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð°Ð½Ð½Ñ ---

machine.makeCoffee('Espresso')

// Ð¡Ð¿Ñ€Ð¾Ð±Ð° Ð·Ñ€Ð¾Ð±Ð¸Ñ‚Ð¸ Ñ‰Ðµ Ð¾Ð´Ð½Ñƒ ÐºÐ°Ð²Ñƒ Ð´Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ Ð¿ÐµÑ€ÑˆÐ¾Ñ—
setTimeout(() => machine.makeCoffee('Latte'), 500)

// Ð†Ð¼Ñ–Ñ‚ÑƒÑ”Ð¼Ð¾ ÑÑ†ÐµÐ½Ð°Ñ€Ñ–Ð¹, Ð´Ðµ Ð²Ð¾Ð´Ð° Ð·Ð°ÐºÑ–Ð½Ñ‡ÑƒÑ”Ñ‚ÑŒÑÑ Ñ– Ð²Ð¸Ð½Ð¸ÐºÐ°Ñ” Ð¿Ð¾Ð¼Ð¸Ð»ÐºÐ°
setTimeout(() => {
    console.log('\n--- Ð†Ð¼Ñ–Ñ‚Ð°Ñ†Ñ–Ñ Ð·Ð°ÐºÑ–Ð½Ñ‡ÐµÐ½Ð½Ñ Ð²Ð¾Ð´Ð¸ ---')
    machine.waterLevel = 0
    machine.makeCoffee('Americano') // Ð¡Ð¿Ñ€Ð¾Ð±Ð° Ð¿Ñ€Ð¸Ð³Ð¾Ñ‚ÑƒÐ²Ð°Ð½Ð½Ñ Ð· 0 Ð²Ð¾Ð´Ð¸
}, 3000)

// ÐŸÐ¾Ð¿Ð¾Ð²Ð½ÑŽÑ”Ð¼Ð¾ Ð²Ð¾Ð´Ñƒ, Ñ‰Ð¾Ð± Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚Ð¸, Ñ‰Ð¾ once() Ð²Ð¶Ðµ Ð½Ðµ ÑÐ¿Ñ€Ð°Ñ†ÑŽÑ”
setTimeout(() => machine.refillWater(), 4000)
setTimeout(() => machine.makeCoffee('Espresso'), 4500)
